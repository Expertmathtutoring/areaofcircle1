<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‚ö™ Circle Area Game</title>
<style>
  body {
    font-family: 'Comic Sans MS', cursive, sans-serif;
    margin: 0; padding: 0;
    background: linear-gradient(135deg, #89f7fe, #66a6ff);
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh;
  }
  h1 {
    margin-top: 20px; color: #fff; text-shadow: 2px 2px 5px #0d47a1;
  }

  .game-card {
    background: rgba(255,255,255,0.95);
    padding: 20px; border-radius: 20px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    display: flex; gap: 20px;
    position: relative; overflow: hidden;
    max-width: 1000px;
  }

  .game-content {
    flex: 1;
    display: flex; flex-direction: column; align-items: center;
  }

  canvas {
    margin: 20px 0; border-radius: 15px; border: 2px solid #0d47a1; background: #fff;
  }

  .right-panel {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    min-width: 180px;
    justify-items: center;
  }

  .tab-btn {
    padding: 10px 15px; font-size: 16px;
    border: none; border-radius: 10px; cursor: pointer;
    background: #1976d2; color: white; font-weight: bold;
    width: 100%;
    text-align: center;
    transition: 0.3s;
  }
  .tab-btn.active { background: #0d47a1; box-shadow: 0 0 10px rgba(0,0,0,0.3); }

  input[type="text"] {
    padding: 12px; font-size: 18px; width: 160px;
    border-radius: 10px; border: 2px solid #0d47a1;
    outline: none; text-align: center; grid-column: span 2;
  }

  .keypad {
    display: flex; flex-wrap: wrap; justify-content: center; gap: 6px;
    grid-column: span 2;
  }
  .keypad button { width: 60px; padding: 8px; font-size: 16px; }

  button.submit-btn {
    padding: 10px 16px; font-size: 16px; grid-column: span 2;
    border-radius: 10px;
    background: #0d47a1; color: #fff; font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
  }
  button.submit-btn:hover { background: #1976d2; }

  .feedback { font-size: 20px; font-weight: bold; min-height: 30px; text-align: center; }
  .progress { font-size: 18px; color: #444; margin-top: 10px; }

  .firework {
    position: absolute; width: 8px; height: 8px; border-radius: 50%;
    pointer-events: none; animation: explode 1.2s forwards;
  }
  @keyframes explode {
    0% {transform: scale(1); opacity: 1;}
    70% {transform: scale(2.5); opacity: 0.9;}
    100% {transform: scale(4); opacity: 0;}
  }

  @media(max-width: 800px){
    .game-card { flex-direction: column; align-items: center; }
    .right-panel { grid-template-columns: repeat(2, 1fr); }
  }
</style>
</head>
<body>

<h1>‚ö™ Circle Area Game</h1>

<div class="game-card">
  <div class="game-content">
    <div class="progress" id="progress"></div>
    <canvas id="shapeCanvas" width="400" height="300"></canvas>
    <div id="feedback" class="feedback"></div>
  </div>

  <div class="right-panel">
    <!-- Operation Tabs -->
    <button class="tab-btn active" onclick="switchMode('radius', event)">Radius</button>
    <button class="tab-btn" onclick="switchMode('diameter', event)">Diameter</button>
    <button class="tab-btn" onclick="restartGame()">Restart üîÑ</button>

    <!-- Answer Input -->
    <input type="text" id="answer" placeholder="Enter area">

    <!-- Keypad -->
    <div class="keypad">
      <button onclick="insertSymbol('œÄ')">œÄ</button>
      <button onclick="insertSymbol('^')">^</button>
      <button onclick="insertSymbol('(')">(</button>
      <button onclick="insertSymbol(')')">)</button>
      <button onclick="insertSymbol('+')">+</button>
      <button onclick="insertSymbol('-')">‚àí</button>
      <button onclick="insertSymbol('*')">√ó</button>
      <button onclick="insertSymbol('/')">√∑</button>
    </div>

    <!-- Submit Button -->
    <button class="submit-btn" onclick="checkAnswer()">Submit ‚úÖ</button>
  </div>
</div>

<audio id="applause" src="https://www.soundjay.com/human/applause-8.mp3"></audio>

<script>
function rand(min,max){return Math.floor(Math.random()*(max-min+1))+min;}

const circles = {
  radius: Array.from({length:10},()=>({r:rand(2,12)})),
  diameter: Array.from({length:10},()=>({d:rand(4,20)}))
};

let mode='radius', filtered=[], currentIndex=0;

function switchMode(selected, ev){
  mode=selected;
  document.querySelectorAll('.tab-btn').forEach(btn=>btn.classList.remove('active'));
  ev.target.classList.add('active');
  filtered=circles[mode];
  shuffle(filtered);
  currentIndex=0;
  loadShape();
}

function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
}

function drawCircle(circle){
  const ctx=document.getElementById("shapeCanvas").getContext("2d");
  ctx.clearRect(0,0,400,300);
  ctx.strokeStyle="#333"; ctx.lineWidth=2; ctx.font="16px Arial"; ctx.fillStyle="#000";

  ctx.beginPath();
  ctx.arc(200,150,80,0,2*Math.PI);
  ctx.stroke();

  if(mode==="radius"){
    ctx.beginPath();
    ctx.moveTo(200,150);
    ctx.lineTo(200+80,150);
    ctx.stroke();
    ctx.fillText(`r=${circle.r}`,200+40,145);
  } else {
    ctx.beginPath();
    ctx.moveTo(200-80,150);
    ctx.lineTo(200+80,150);
    ctx.stroke();
    ctx.fillText(`d=${circle.d}`,200-10,145);
  }
}

function loadShape(){
  const circle=filtered[currentIndex];
  drawCircle(circle);
  document.getElementById('answer').value='';
  document.getElementById('feedback').textContent='';
  document.getElementById('progress').textContent=`Question ${currentIndex+1} of ${filtered.length}`;
}

function calcArea(circle){
  if(mode==="radius"){
    return Math.PI*circle.r*circle.r;
  } else {
    const r=circle.d/2;
    return Math.PI*r*r;
  }
}

function preprocessInput(str){
  return str
    .replace(/œÄ/g,"Math.PI")
    .replace(/(\d)(Math\.PI)/g,"$1*$2")
    .replace(/(Math\.PI)(\d)/g,"$1*$2")
    .replace(/\^/g,"**");
}

const positiveResponses = [
  "üéâ Correct! Amazing job!",
  "üëè Bravo! You nailed it!",
  "üåü Perfect! You're a star!",
  "üî• Awesome work! Keep it up!"
];
const negativeResponses = [
  "‚ùå Oops! Try again!",
  "üòÖ Not quite, give it another shot!",
  "üö´ Wrong, but you can do it!",
  "ü§î Close! Try once more!"
];

function checkAnswer(){
  const circle=filtered[currentIndex];
  const feedback=document.getElementById('feedback');
  const correctValue=calcArea(circle);
  let userInput=document.getElementById('answer').value.trim();

  userInput = preprocessInput(userInput);

  let userValue;
  try{ userValue=eval(userInput); }catch{ userValue=NaN; }

  const rounded1 = parseFloat(correctValue.toFixed(1));
  const rounded2 = parseFloat(correctValue.toFixed(2));
  const rounded3 = parseFloat(correctValue.toFixed(3));

  const isCorrect =
    Math.abs(userValue - correctValue) < 0.5 ||
    userValue === rounded1 ||
    userValue === rounded2 ||
    userValue === rounded3;

  if(isCorrect){
    feedback.textContent=positiveResponses[Math.floor(Math.random()*positiveResponses.length)];
    feedback.style.color='green';
    showFireworks();
    document.getElementById("applause").play();
    setTimeout(()=>{
      currentIndex++;
      if(currentIndex>=filtered.length){
        feedback.textContent='üèÜ Well done! You finished this set!';
        shuffle(filtered); currentIndex=0;
        setTimeout(loadShape,2000);
      } else loadShape();
    },1500);
  } else {
    feedback.textContent=negativeResponses[Math.floor(Math.random()*negativeResponses.length)];
    feedback.style.color='red';
  }
}

function restartGame(){ shuffle(filtered); currentIndex=0; loadShape(); }

function showFireworks(){
  for(let i=0;i<15;i++){
    const fw=document.createElement('div');
    fw.className='firework';
    fw.style.left=(100+Math.random()*200)+'px';
    fw.style.top=(50+Math.random()*150)+'px';
    fw.style.background=`hsl(${Math.random()*360},100%,50%)`;
    document.querySelector('.game-card').appendChild(fw);
    setTimeout(()=>fw.remove(),1200);
  }
}

function insertSymbol(sym){
  const input=document.getElementById("answer");
  input.value+=sym;
  input.focus();
}

document.getElementById("answer").addEventListener("keypress", function(e){
  if(e.key === "Enter"){ checkAnswer(); }
});

switchMode('radius',{target:document.querySelector('.tab-btn')});
</script>
</body>
</html>


